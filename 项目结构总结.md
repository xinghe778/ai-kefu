# YiZi AI 项目结构总结

## 📁 项目目录结构

```
yiZi-AI/
├── 📄 1.html                           # 静态HTML版本聊天界面
├── 📄 index.php                        # 主聊天界面 (现代化版本)
├── 📄 index2.php                       # 简化版聊天界面
├── 📄 readme.md                        # 项目说明文档
├── 📄 更新说明_V3.0.md                  # V3.0版本更新说明
│
├── 📁 admin/                           # 后台管理系统
│   ├── 📄 index.php                    # 后台首页
│   ├── 📄 login.php                    # 管理员登录 (已优化)
│   ├── 📄 register.php                 # 用户注册 (已修复)
│   ├── 📄 logout.php                   # 退出登录
│   ├── 📄 auth.php                     # 认证检查
│   ├── 📄 config.php                   # 数据库配置
│   ├── 📄 db.php                       # 数据库连接
│   ├── 📄 header.php                   # 后台头部
│   ├── 📄 footer.php                   # 后台底部
│   ├── 📄 style.css                    # 样式文件
│   │
│   ├── 📄 modelapi.php                 # AI模型API接口 (核心)
│   ├── 📄 kbapi.php                    # 知识库API (已完善)
│   ├── 📄 fileapi.php                  # 文件上传API (新增)
│   ├── 📄 log.php                      # 日志记录API (已完善)
│   │
│   ├── 📄 settings.php                 # 系统设置页面
│   ├── 📄 kb-manager.php               # 知识库管理 (界面已存在)
│   ├── 📄 kb_categories.php            # 知识库分类管理
│   ├── 📄 users.php                    # 用户管理
│   ├── 📄 user-edit.php                # 用户编辑
│   ├── 📄 user-delete.php              # 用户删除
│   ├── 📄 log-delete.php               # 日志删除
│   │
│   └── 📄 logs.php                     # 系统日志页面
│
├── 📁 uploads/                         # 文件上传目录
│   ├── 📁 kb/                          # 知识库文件
│   └── 📁 files/                       # 用户上传文件
│
├── 📁 install/                         # 安装文件
│   ├── 📄 database_init.sql            # 数据库初始化脚本
│   └── 📄 安装指南.md                    # 安装说明文档
│
└── 📁 tmp/                             # 临时文件目录 (可选)
```

## 🔧 核心文件功能说明

### 前端文件
- **index.php** - 主要聊天界面，支持文件上传、主题切换、响应式设计
- **index2.php** - 简化版聊天界面
- **1.html** - 静态HTML版本，用于测试和演示

### 后台管理
- **login.php** - 管理员登录，现代化UI设计
- **register.php** - 用户注册，支持角色分配
- **auth.php** - 权限验证中间件
- **db.php** - 数据库连接管理

### API接口
- **modelapi.php** - AI对话核心接口，支持多种模型
- **kbapi.php** - 知识库CRUD操作，支持全文搜索
- **fileapi.php** - 文件上传管理，支持多种格式
- **log.php** - 聊天记录和系统日志

### 页面管理
- **settings.php** - 系统配置管理
- **kb-manager.php** - 知识库内容管理
- **users.php** - 用户账户管理
- **logs.php** - 系统日志查看

## 🚀 新增功能特性

### 1. 完整的用户系统
- ✅ 用户注册/登录
- ✅ 角色权限管理 (admin/user/guest)
- ✅ 会话安全控制
- ✅ 密码加密存储

### 2. 知识库管理
- ✅ 分类管理系统
- ✅ 文档上传和存储
- ✅ 全文搜索功能
- ✅ 批量导入导出

### 3. 文件处理系统
- ✅ 多格式文件支持 (txt/pdf/docx/csv等)
- ✅ 文件安全验证
- ✅ 内容预览功能
- ✅ 上传状态追踪

### 4. 系统监控
- ✅ 聊天记录完整保存
- ✅ 用户行为追踪
- ✅ 系统性能统计
- ✅ 错误日志收集

### 5. 界面优化
- ✅ 现代化UI设计
- ✅ 响应式布局
- ✅ 主题切换功能
- ✅ 移动端优化

## 🔐 安全性改进

### 数据安全
- 密码使用PHP password_hash加密
- SQL注入防护 (预处理语句)
- XSS攻击防护 (HTML转义)
- CSRF保护

### 文件安全
- 文件类型白名单验证
- 文件大小限制 (10MB)
- 文件名安全处理
- 路径遍历防护

### 会话安全
- 安全会话配置
- 会话超时控制
- 登录状态验证
- 权限分级管理

## 📊 数据库设计

### 表结构概览
- **users** - 用户信息表
- **settings** - 系统配置表
- **kb_categories** - 知识库分类表
- **kb_entries** - 知识库内容表
- **chat_logs** - 聊天记录表
- **file_uploads** - 文件上传表

### 索引优化
- 用户表：用户名、邮箱唯一索引
- 知识库表：全文搜索索引
- 日志表：时间、用户索引
- 文件表：类型、时间索引

## 🔧 配置说明

### 数据库配置
```php
// admin/config.php
define('DB_HOST', 'localhost');
define('DB_NAME', 'api');
define('DB_USER', 'your_username');
define('DB_PASS', 'your_password');
```

### 文件权限
```bash
chmod 755 uploads/
chmod 755 admin/
chmod 644 *.php
```

## 📈 性能优化

### 后端优化
- 数据库连接池
- 查询缓存机制
- 索引优化
- 代码压缩

### 前端优化
- 静态资源CDN
- 图片懒加载
- CSS/JS压缩
- 缓存策略

## 🧪 测试建议

### 功能测试
1. 用户注册/登录流程
2. 文件上传/下载功能
3. 知识库搜索功能
4. AI对话响应
5. 后台管理功能

### 安全测试
1. SQL注入测试
2. XSS攻击测试
3. 文件上传安全
4. 权限绕过测试

### 性能测试
1. 并发用户测试
2. 大文件上传测试
3. 数据库查询性能
4. 页面加载速度

## 📝 维护指南

### 定期维护
- 数据库备份
- 日志文件清理
- 临时文件清理
- 性能监控

### 更新流程
1. 备份现有数据
2. 测试环境验证
3. 生产环境部署
4. 功能验证确认

---

**项目版本**: V3.0  
**最后更新**: 2025-11-23  
**维护状态**: 活跃维护中